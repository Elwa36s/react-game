(this["webpackJsonpreact-game"]=this["webpackJsonpreact-game"]||[]).push([[0],{21:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),o=n(5),s=n.n(o),i=n(4),a=n(3),u=n(2),l="UP",d="DOWN",b="LEFT",j="RIGHT",f="INIT_GAME",O="CHECK_WIN",p="CHECK_LOSE",m="CHECK_SCORE",v="LOAD_LAST_GAME",h="SETTINGS",S="SHOW_SCORE",g="MUTE_SOUND",x="RESET_BEST_SCORE";function y(e){var t=[];return e.forEach((function(e,n){var c=Math.floor(n/4);t[c]=t[c]||[],t[c].push(e)})),t}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=t-1,c=e[0].map((function(t,n){return e.map((function(e){return e[n]})).reverse()}));return 0===n?c:E(c,n)}function w(e){for(var t=[],n=[],c=0;c<4;c++){for(var r=e[c],o=(r=r.filter((function(e){return 0!==e}))).length;o>=0;o--)r[o]===r[o-1]&&(isNaN(r[o-1])||(r[o]+=r[o-1]+1,r[o-1]=0,r=r.filter((function(e){return 0!==e}))));r=r.map((function(e){return e%2===1?e-=1:e})),n.push(r)}for(var s=0;s<4;s++){var i=n[s];t.push(N(i))}return t}function N(e){return e.length<4&&e.unshift(0),4===e.length?e:N(e)}function _(e){var t=[];return e.forEach((function(e,n){0===e&&t.push(n)})),t}function k(e){var t=_(e);function n(e){return Math.floor(Math.random()*Math.floor(e))}var c=[2,4,2,2,2,2,2,2,4,2][n(10)];return e[t[n(t.length)]]=c,e}function C(e,t){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!0}function L(){for(var e=[],t=0;t<16;t++)e.push(0);var n=k(e);return n=k(n)}function I(e){return e.reduce((function(e,t){return e+t}),0)}function T(e){return 0!==e.filter((function(e){return 2048===e})).length}function R(e){if(0===_(e).length){for(var t=[],n=0;n<e.length;n++)e[n]===e[n+1]&&3!==n&&7!==n&&11!==n&&t.push(e[n]),n<=11&&e[n]===e[n+4]&&t.push(e[n]);return 0===t.length}return!1}var D=n.p+"static/media/win.b64b2bab.mp3",G=n.p+"static/media/lose.ff6198f5.mp3",F=n.p+"static/media/keypress.f26ec9a9.mp3",M=new Audio(D),A=new Audio(G),B=new Audio(F),U={tiles:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],currentScore:0,bestScore:0,moves:0,win:!1,lose:!1,top10:[],gameStop:!1,muted:!1},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0,n=e.tiles,c=e.moves,r=[].concat(n),o=y(r),s=e.bestScore;switch(t.type){case l:var i=t.payload,a=4-i,h=E(o,i),S=w(h),N=E(S,a).flat(1);return C(r,N)&&!e.gameStop?(N=k(N),c+=1,e.muted||B.play(),Object(u.a)(Object(u.a)({},e),{},{tiles:N,moves:c})):Object(u.a)({},e);case d:var _=t.payload,D=4-_,G=E(o,_),F=w(G),W=E(F,D).flat(1);return C(r,W)&&!e.gameStop?(W=k(W),c+=1,e.muted||B.play(),Object(u.a)(Object(u.a)({},e),{},{tiles:W,moves:c})):Object(u.a)({},e);case b:var H=t.payload,J=4-H,X=E(o,H),K=w(X),P=E(K,J).flat(1);return C(r,P)&&!e.gameStop?(P=k(P),c+=1,e.muted||B.play(),Object(u.a)(Object(u.a)({},e),{},{tiles:P,moves:c})):Object(u.a)({},e);case j:var V=w(o),Y=V.flat(1);return C(r,Y)&&!e.gameStop?(Y=k(Y),c+=1,e.muted||B.play(),Object(u.a)(Object(u.a)({},e),{},{tiles:Y,moves:c})):Object(u.a)({},e);case f:var q=L();return Object(u.a)(Object(u.a)({},e),{},{tiles:q,moves:0,currentScore:0,win:!1,lose:!1,gameStop:!1});case O:var z=e.win,Q=T(n),Z=e.top10;return Q!==z&&(Z.push({score:e.currentScore,moves:e.moves}),e.muted||M.play()),Q?Object(u.a)(Object(u.a)({},e),{},{win:Q,gameStop:Q,top10:Z}):Object(u.a)({},e);case p:var $=e.lose,ee=R(n),te=e.top10;return ee!==$&&(te.push({score:e.currentScore,moves:e.moves}),e.muted||A.play()),ee?Object(u.a)(Object(u.a)({},e),{},{lose:ee,gameStop:ee,top10:te}):Object(u.a)({},e);case m:var ne=I(n);return ne>s?Object(u.a)(Object(u.a)({},e),{},{currentScore:ne,bestScore:ne}):Object(u.a)(Object(u.a)({},e),{},{currentScore:ne});case v:var ce=JSON.parse(localStorage.getItem("lastState"));return null!==ce?Object(u.a)(Object(u.a)({},e),ce):e;case x:var re=0,oe=[];return Object(u.a)(Object(u.a)({},e),{},{top10:oe,bestScore:re});case g:var se=!e.muted;return Object(u.a)(Object(u.a)({},e),{},{muted:se});default:return e}},H={settingsIsOpen:!1,score:!1},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:var n=!e.settingsIsOpen;return Object(u.a)(Object(u.a)({},e),{},{settingsIsOpen:n});case S:var c=!e.score;return Object(u.a)(Object(u.a)({},e),{},{score:c});default:return e}},X=Object(a.b)({field:W,buttons:J}),K=(n(21),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,30)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),c(e),r(e),o(e),s(e)}))}),P=(n(22),n(23),n(1));function V(e){return Object(P.jsx)("div",{className:"tile tile-".concat(e.value),children:e.value})}function Y(){return{type:f}}var q={moveUp:function(){return{type:l,payload:1}},moveDown:function(){return{type:d,payload:3}},moveLeft:function(){return{type:b,payload:2}},moveRight:function(){return{type:j,payload:4}},initGame:Y,loadGame:function(){return{type:v}}},z=Object(i.b)((function(e){return Object(u.a)(Object(u.a)({},e.field),{},{muted:e.field.muted})}),q)((function(e){Object(c.useEffect)((function(){return document.addEventListener("keydown",(function(e){t(e)})),function(){document.removeEventListener("keydown",(function(e){t(e)}))}}),[]),Object(c.useEffect)((function(){e.loadGame()}),[]),Object(c.useEffect)((function(){n(e)}),[e]);var t=function(t){switch(t.keyCode){case 37:case 65:e.moveLeft();break;case 38:case 87:e.moveUp();break;case 39:case 68:e.moveRight();break;case 40:case 83:e.moveDown();break;case 82:e.initGame()}},n=function(e){var t=JSON.stringify(e);localStorage.setItem("lastState",t)};return e.lose?Object(P.jsxs)("div",{className:"endScreen",id:"loseScreen",children:[Object(P.jsx)("p",{children:"Game over! =("}),Object(P.jsxs)("p",{children:["You reached ",e.currentScore," in ",e.moves," steps"]})]}):e.win?Object(P.jsxs)("div",{className:"endScreen",id:"winScreen",children:[Object(P.jsx)("p",{children:"Congratulations!"}),Object(P.jsxs)("p",{children:["You win the game with ",e.currentScore," score in ",e.moves," steps!"]})]}):e.win||e.lose?void 0:Object(P.jsx)("div",{id:"field",children:y(e.tiles).map((function(e,t){return Object(P.jsx)("div",{className:"tileLine",children:e.map((function(e,n){return Object(P.jsx)(V,{value:e},4*t+n)}))},t)}))})}));n(25);var Q={initGame:Y,settings:function(){return{type:h}},mute:function(){return{type:g}},leaderBoard:function(){return{type:S}},resetScore:function(){return{type:x}}},Z=Object(i.b)((function(e){return{modal:e.buttons.settingsIsOpen,muted:e.buttons.muted,score:e.buttons.score,top10:e.field.top10}}),Q)((function(e){return Object(P.jsxs)("div",{id:"btns",children:[Object(P.jsx)("button",{type:"button",onClick:e.initGame,children:"New game"}),Object(P.jsx)("button",{type:"button",onClick:e.settings,children:"Settings"}),Object(P.jsx)("p",{id:"rules",children:"Use arrows or WASD to move, R - for new game"}),e.modal&&Object(P.jsxs)("div",{id:"settings",children:[Object(P.jsx)("button",{type:"button",className:"set",onClick:e.leaderBoard,children:"Show best scores"}),Object(P.jsx)("button",{type:"button",className:"set",onClick:e.resetScore,children:"Reset statistics"}),Object(P.jsx)("button",{type:"button>",className:"set",onClick:e.mute,children:"Sound on/off"}),Object(P.jsx)("button",{type:"button",className:"set",onClick:e.settings,children:"Close settings"})]}),e.score&&Object(P.jsxs)("div",{id:"leaderBoard",children:[Object(P.jsx)("button",{type:"button",className:"closeSetts",onClick:e.leaderBoard,children:"\xd7"}),(t=e.top10,t.sort((function(e,t){return t.score-e.score})).slice(0,10)).map((function(e,t){return Object(P.jsxs)("p",{className:"top",children:[t+1,". ",e.score," points in ",e.moves," steps"]},t)}))]})]});var t}));n(26);var $={checkForLose:function(){return{type:p}},checkForWin:function(){return{type:O}},calcScore:function(){return{type:m}}},ee=Object(i.b)((function(e){return{currentScore:e.field.currentScore,bestScore:e.field.bestScore,moves:e.field.moves}}),$)((function(e){return Object(c.useEffect)((function(){e.checkForWin(),e.checkForLose(),e.calcScore()}),[e]),Object(P.jsxs)("div",{id:"stat",children:[Object(P.jsxs)("section",{id:"score",children:["Score: ",e.currentScore]}),Object(P.jsxs)("section",{id:"moves",children:["Steps: ",e.moves]}),Object(P.jsxs)("section",{id:"bestScore",children:["Best score: ",e.bestScore]})]})})),te=(n(27),n.p+"static/media/rs_school_js.ad178c0d.svg");function ne(){return Object(P.jsx)("footer",{children:Object(P.jsxs)("div",{id:"information",children:[Object(P.jsx)("div",{id:"school",children:Object(P.jsx)("a",{href:"https://rs.school/js/",id:"rsLink",children:Object(P.jsx)("img",{src:te,alt:"RSSchoolLogo"})})}),Object(P.jsxs)("p",{id:"me",children:["Made by ",Object(P.jsx)("a",{href:"https://github.com/Elwa36s",children:"Elwa36s,"}),Object(P.jsx)("br",{}),"2021"]})]})})}n(28);var ce=function(){return Object(P.jsxs)("div",{id:"app",children:[Object(P.jsx)(Z,{}),Object(P.jsx)(ee,{}),Object(P.jsx)(z,{}),Object(P.jsx)(ne,{})]})},re=Object(a.d)(X,Object(a.c)(window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()));s.a.render(Object(P.jsx)(r.a.StrictMode,{children:Object(P.jsx)(i.a,{store:re,children:Object(P.jsx)(ce,{})})}),document.getElementById("root")),K()}},[[29,1,2]]]);
//# sourceMappingURL=main.bf2ece38.chunk.js.map